<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PHPSDK: MMS MT API guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="BlueviaLogo.jpg"></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">PHPSDK&#160;<span id="projectnumber">1.6</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('blv_php_mmsmt_guide.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<h1>MMS MT API guide </h1>  </div>
</div>
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="blv_mms_mt_api_sending_mms_messages_sec"></a>
Bluevia MMS MT API: Sending MMS messages</h2>
<p>The Bluevia MMS API is a set of functions which allows users to send MMS messages and to request the status of those previously sent MMS messages. This guide represents a practical introduction to developing applications in which the user wants to provide the Bluevia MMS functionality. You can learn more about this API at Bluevia's <a href="https://bluevia.com/en/page/tech.APIs.MmsAPI" target="blank">Mms API</a> reference.</p>
<h3><a class="anchor" id="mms_mt_client_basics_sec"></a>
MMS MT client basics</h3>
<p>A MMS client represents the client side in a classic client-server schema. This object wraps up the underlying REST client side functionality needed to perform requests against a REST server.</p>
<p>Any Bluevia client performs requests and receives responses in a secure mode. Clients are authorized following the OAuth protocol. This security protocol enables users to grant third-party access to their resources without sharing their passwords. So clients store the authorization data -called security credentials- to grant access to the server. Following sections describe what security credentials we are talking about.</p>
<h3><a class="anchor" id="creating_a_mms_mt_client_sec"></a>
Creating a MMS MT client: BV_MtMms class</h3>
<p>The first step in using the MMS client is to create a <a class="el" href="class_b_v___mt_mms.html" title="Client interface for the REST binding of the Bluevia MMS MT Service.">BV_MtMms</a> object. As we mentioned earlier this object could have two different working modes: i) as a client which sends requests to a real server, or ii) as a client which sends requests and receives responses to/from a sandbox server.</p>
<h4><a class="anchor" id="mms_mt_client_features_working_modes_sec"></a>
MMS MT client features: working modes</h4>
<p>When you create the client, you can specify various working modes: </p>
<ul>
<li>
<p class="startli"><a class="el" href="class_b_v___mode.html#abc1c5fcc41548942acf01ed32d31f4f0" title="In the Live environment your application uses the real network.">BV_Mode::LIVE</a> <br/>
In the Live environment your application uses the real network, which means that you will be able to send real transactions to real Movistar, O2 and Vivo customers in the applicable country.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><a class="el" href="class_b_v___mode.html#a8d7759e13bc0c420f06a21e219e9da76" title="In the Test environment your application uses the real network.">BV_Mode::TEST</a> <br/>
The Test mode behave exactly like the Live mode, but the API calls are free of chargue, using a credits system. You are required to have a Movistar, O2 or Vivo mobile number to get this monthly credits.</p>
<p class="endli"></p>
</li>
<li>
<a class="el" href="class_b_v___mode.html#a0bda8698e06a60ea5d2db01f4c0cd488" title="No traffic Generated.">BV_Mode::SANDBOX</a> <br/>
The Sandbox environment offers you the exact same experience as the Live environment except that no traffic is generated on the live network, meaning you can experiment and play until your heartâ€™s content. </li>
</ul>
<h4><a class="anchor" id="mms_mt_client_features_security_credentials"></a>
MMS MT client features: security credentials</h4>
<p>Bluevia uses OAuth as its authentication mechanism which enables websites and applications to access the Bluevia API's without end users disclosing their personal credentials. In order to grant access to the server any client has to be created passing the security credential as parameter in its constructor. These security credentials are managed internally and added as a HTTP header in every request sent to the server. Such OAuth security credentials are: </p>
<ul>
<li>
<p class="startli"><b>Consumer key</b> <br/>
The string identifying the application- you obtained when you registered your application within the provisioning portal.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Consumer secret</b> <br/>
A secret -a string- used by the consumer to establish ownership of the consumer key.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Access token</b> <br/>
The token -a string- used by the client for granting access permissions to the server.</p>
<p class="endli"></p>
</li>
<li>
<b>Access token secret</b> <br/>
The secret of the access token. </li>
</ul>
<p>To get consumer credentials for your application, visit the API authentication reference for more information about <a href="https://bluevia.com/en/page/tech.howto.tut_APIauth" target="blank">getting Consumer credentials</a>.</p>
<p>You can learn how to obtain the access tokens <a class="el" href="blv_php_oauth_guide.html">here</a>.</p>
<h4><a class="anchor" id="mms_mt_client_features_code_examples_sec"></a>
MMS MT client features: code example</h4>
<p>Find below an example about how to create a Mms client object taking into account all information previously given. This snippet shows how to access a Bluevia server using OAuth security credentials</p>
<div class="fragment"><pre class="fragment"><span class="comment">// BV_Mode::LIVE indicating the client works against a real Bluevia server.</span>
<span class="keywordflow">try</span> {
        $mmsClient = <span class="keyword">new</span> <a class="code" href="class_b_v___mt_mms.html" title="Client interface for the REST binding of the Bluevia MMS MT Service.">BV_MtMms</a>(<a class="code" href="class_b_v___mode.html#abc1c5fcc41548942acf01ed32d31f4f0" title="In the Live environment your application uses the real network.">BV_Mode::LIVE</a>, <span class="stringliteral">&quot;consumer_key&quot;</span>, <span class="stringliteral">&quot;consumer_secret&quot;</span>, <span class="stringliteral">&quot;access_token&quot;</span>, <span class="stringliteral">&quot;access_token_secret&quot;</span>);
} <span class="keywordflow">catch</span> (<a class="code" href="class_bluevia___exception.html" title="Base class for Exceptions.">Bluevia_Exception</a> e){
        print $e-&gt;getMessage();
}
</pre></div><h3><a class="anchor" id="sending_mms_messages_sec"></a>
Sending MMS messages</h3>
<p>The <a class="el" href="class_b_v___mt_mms.html" title="Client interface for the REST binding of the Bluevia MMS MT Service.">BV_MtMms</a> object has different ways for sending MMS messages. A subject and at least one destination has to be defined to send the message. Other destinations, a text, and multimedia attachemtns can be included also. In addition, an endpoint and a correlator can be defined in order to receive delivery status notifications.</p>
<p>Take a look at these three ways to call the send function:</p>
<div class="fragment"><pre class="fragment"> send($destination, $subject, $message)
</pre></div><p>It sends a MMS message to one recipient including a subject and a text message.</p>
<div class="fragment"><pre class="fragment"> send($destination, $subject, $message, $attachments)
</pre></div><p>It sends a MMS message to one recipient including a subject, a text message and any number of multimedia attachments.</p>
<div class="fragment"><pre class="fragment"> send($destination,$subject, $message, $attachments, $endpoint, $correlator)  
</pre></div><p>It sends a MMS message to one recipient including a subject, a text message and any number of multimedia attachments, and includes the endpoint and correlator to receive delivery notifications.</p>
<p>You can pass an array of destinations instead of just one, for sending to multiple destinations. This function returns a MMS Id which indentifies that sending operation. This identification is useful to retrieve the delivery status of that MMS message using a polling strategy.</p>
<p>MMS weight is limited to 300 KB.</p>
<p>For a more detailed description see the <a class="el" href="class_b_v___mt_mms.html#af88a5b57297d56f7d9ae8cc515cbf68b" title="Enables your application to send an MMS on behalf of the user.">BV_MtMms::send</a>.</p>
<h4><a class="anchor" id="mms_mt_message_features_adding_attachments_sec"></a>
Attachments of the MMS message</h4>
<p>The class that represent multipart attachment is <a class="el" href="class_attachment.html" title="Class containing the attachment path in your file system and content-type.">Attachment</a>. Several attachments could be attached to the MMS message. You can instantiate an attachment:</p>
<div class="fragment"><pre class="fragment">$attachment = <span class="keyword">new</span> <a class="code" href="class_attachment.html" title="Class containing the attachment path in your file system and content-type.">Attachment</a>($path_to_file, BV_Mimetype::JPEG)
</pre></div><p>For a more detailed description see <a class="el" href="class_attachment.html" title="Class containing the attachment path in your file system and content-type.">Attachment</a> class. You can find all mimetype constants in <a class="el" href="class_b_v___mimetype.html" title="Class representing the mimetypes supported by Bluevia.">BV_Mimetype</a> class.</p>
<h4><a class="anchor" id="mms_message_features_content"></a>
MMS message features: available content types</h4>
<p>The following list contains the available content-types in Bluevia:</p>
<ul>
<li>
text/plain </li>
<li>
image/jpeg </li>
<li>
image/bmp </li>
<li>
image/gif </li>
<li>
image/png </li>
<li>
audio/amr </li>
<li>
audio/midi </li>
<li>
audio/mp3 </li>
<li>
audio/mpeg </li>
<li>
audio/wav </li>
<li>
video/mp4 </li>
<li>
video/avi </li>
<li>
video/3gpp </li>
</ul>
<p>For a more detailed description see <a class="el" href="class_b_v___mimetype.html" title="Class representing the mimetypes supported by Bluevia.">BV_Mimetype</a> class.</p>
<h3><a class="anchor" id="requesting_status_sec"></a>
Requesting the status of a previously sent MMS messages</h3>
<p>Once the MMS message is sent successfully the user may want to know the delivery status of that MMS message. The Mms client allows a user to determine if the MMS message reaches the destination or not. For this matter we use the getDeliveryStatus function. Just pass the MMS Id -returned by the send function- and retrieve the delivery status of that message, that easy!.</p>
<p>Take a look at this function: </p>
<div class="fragment"><pre class="fragment"><span class="keyword">public</span> function getDeliveryStatus($messageId)
</pre></div><p> It obtains the delivery status of a previously sent MMS message.</p>
<p>Possible delivery statuses are: </p>
<ul>
<li>
DeliveredToNetwork. </li>
<li>
DeliveryUncertain. </li>
<li>
DeliveryImpossible. </li>
<li>
MessageWaiting. </li>
<li>
DeliveredToTerminal. </li>
<li>
DeliveryNotificationNotSupported. </li>
</ul>
<p>For a more detailed description see the <a class="el" href="class_b_v___mt___client.html#a7efe79b84683358846e69990c1b04727" title="Allows to know the delivery status of a previous sent message using Bluevia API.">BV_MtMms::getDeliveryStatus</a>.</p>
<h3><a class="anchor" id="mms_api_code_example_sec"></a>
Bluevia MMS MT API: code example</h3>
<div class="fragment"><pre class="fragment"><span class="comment">// Send an MMS</span>
        

<span class="keywordflow">try</span> {
        <span class="comment">// 1. Create the client (you have to choose the mode and include the OAuth authorization values)</span>
        $mmsClient = <span class="keyword">new</span> <a class="code" href="class_b_v___mt_mms.html" title="Client interface for the REST binding of the Bluevia MMS MT Service.">BV_MtMms</a>(<a class="code" href="class_b_v___mode.html#abc1c5fcc41548942acf01ed32d31f4f0" title="In the Live environment your application uses the real network.">BV_Mode::LIVE</a>, <span class="stringliteral">&quot;consumer_key&quot;</span>, <span class="stringliteral">&quot;consumer_secret&quot;</span>, <span class="stringliteral">&quot;access_token&quot;</span>, <span class="stringliteral">&quot;access_token_secret&quot;</span>);


        <span class="comment">// 2. Prepare the attachments (in this example we assume it is a file located at your file system)</span>
        <span class="comment">// To create the Attachment we need the path the file and the content-type</span>
        $attachments=array();
        $attachments[]= <span class="keyword">new</span> <a class="code" href="class_attachment.html" title="Class containing the attachment path in your file system and content-type.">Attachment</a>(<span class="stringliteral">&quot;/path/to/image/image.gif&quot;</span>,BV_Mimetype::IMAGE_GIF);
        $attachments[]= <span class="keyword">new</span> <a class="code" href="class_attachment.html" title="Class containing the attachment path in your file system and content-type.">Attachment</a>(<span class="stringliteral">&quot;/path/to/image/image2.jpeg&quot;</span>,BV_Mimetype::IMAGE_JPEG);

        <span class="comment">// 3. Send the message.</span>
        
        $mmsId = $mmsClient-&gt;send(<span class="stringliteral">&quot;600010101&quot;</span>, <span class="stringliteral">&quot;This is a MMS&quot;</span> <span class="stringliteral">&quot;This is the text of the MMS to be sent using Bluevia API&quot;</span>, $attachments);


        <span class="comment">// 4. Retrieve the delivery status of the sent MMS.</span>
        $statusInfo = $mmsClient-&gt;getDeliveryStatus($mmsId);
        <span class="keywordflow">foreach</span> ($statusInfo as $status)
        print $status-&gt;stauts.<span class="stringliteral">&#39;: &#39;</span>.$status-&gt;statusDescription;
        }

} <span class="keywordflow">catch</span> (<a class="code" href="class_bluevia___exception.html" title="Base class for Exceptions.">Bluevia_Exception</a> e) {
        print <span class="stringliteral">&quot;Error sending MMS: &quot;</span>.$e-&gt;getMessage();
{
</pre></div> </div></div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="footer">Generated on Thu May 24 2012 09:22:37 for PHPSDK by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </li>
    </ul>
  </div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
